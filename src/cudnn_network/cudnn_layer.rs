// Stolen from cuda mnist sample