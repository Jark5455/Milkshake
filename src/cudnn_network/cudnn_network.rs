// The following code is stolen and reinterpreted from cudnn mnist sample